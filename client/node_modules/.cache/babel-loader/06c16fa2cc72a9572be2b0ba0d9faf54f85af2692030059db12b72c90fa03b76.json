{"ast":null,"code":"const DB_NAME = 'prof_senegal_offline';\nconst DB_VERSION = 1;\nconst openDB = () => {\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n    request.onupgradeneeded = event => {\n      const db = event.target.result;\n      if (!db.objectStoreNames.contains('pendingActions')) {\n        db.createObjectStore('pendingActions', {\n          keyPath: 'id',\n          autoIncrement: true\n        });\n      }\n      if (!db.objectStoreNames.contains('cachedData')) {\n        db.createObjectStore('cachedData', {\n          keyPath: 'key'\n        });\n      }\n    };\n    request.onsuccess = () => resolve(request.result);\n    request.onerror = () => reject(request.error);\n  });\n};\n\n// Sauvegarder des données en cache local\nexport const cacheData = async (key, data) => {\n  const db = await openDB();\n  const tx = db.transaction('cachedData', 'readwrite');\n  tx.objectStore('cachedData').put({\n    key,\n    data,\n    timestamp: Date.now()\n  });\n  return new Promise(resolve => {\n    tx.oncomplete = resolve;\n  });\n};\n\n// Récupérer des données du cache local\nexport const getCachedData = async key => {\n  const db = await openDB();\n  const tx = db.transaction('cachedData', 'readonly');\n  const request = tx.objectStore('cachedData').get(key);\n  return new Promise(resolve => {\n    request.onsuccess = () => {\n      var _request$result;\n      return resolve(((_request$result = request.result) === null || _request$result === void 0 ? void 0 : _request$result.data) || null);\n    };\n  });\n};\n\n// Sauvegarder une action à synchroniser plus tard\nexport const savePendingAction = async action => {\n  const db = await openDB();\n  const tx = db.transaction('pendingActions', 'readwrite');\n  tx.objectStore('pendingActions').add({\n    ...action,\n    timestamp: Date.now()\n  });\n  return new Promise(resolve => {\n    tx.oncomplete = resolve;\n  });\n};\n\n// Récupérer toutes les actions en attente\nexport const getPendingActions = async () => {\n  const db = await openDB();\n  const tx = db.transaction('pendingActions', 'readonly');\n  const request = tx.objectStore('pendingActions').getAll();\n  return new Promise(resolve => {\n    request.onsuccess = () => resolve(request.result || []);\n  });\n};\n\n// Supprimer une action synchronisée\nexport const removePendingAction = async id => {\n  const db = await openDB();\n  const tx = db.transaction('pendingActions', 'readwrite');\n  tx.objectStore('pendingActions').delete(id);\n  return new Promise(resolve => {\n    tx.oncomplete = resolve;\n  });\n};\n\n// Vérifier si on est en ligne\nexport const isOnline = () => navigator.onLine;","map":{"version":3,"names":["DB_NAME","DB_VERSION","openDB","Promise","resolve","reject","request","indexedDB","open","onupgradeneeded","event","db","target","result","objectStoreNames","contains","createObjectStore","keyPath","autoIncrement","onsuccess","onerror","error","cacheData","key","data","tx","transaction","objectStore","put","timestamp","Date","now","oncomplete","getCachedData","get","_request$result","savePendingAction","action","add","getPendingActions","getAll","removePendingAction","id","delete","isOnline","navigator","onLine"],"sources":["/Users/yuupeegs/Desktop/APP PROF/prof-senegal/client/src/utils/offlineStorage.js"],"sourcesContent":["const DB_NAME = 'prof_senegal_offline';\nconst DB_VERSION = 1;\n\nconst openDB = () => {\n  return new Promise((resolve, reject) => {\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n\n    request.onupgradeneeded = (event) => {\n      const db = event.target.result;\n      if (!db.objectStoreNames.contains('pendingActions')) {\n        db.createObjectStore('pendingActions', { keyPath: 'id', autoIncrement: true });\n      }\n      if (!db.objectStoreNames.contains('cachedData')) {\n        db.createObjectStore('cachedData', { keyPath: 'key' });\n      }\n    };\n\n    request.onsuccess = () => resolve(request.result);\n    request.onerror = () => reject(request.error);\n  });\n};\n\n// Sauvegarder des données en cache local\nexport const cacheData = async (key, data) => {\n  const db = await openDB();\n  const tx = db.transaction('cachedData', 'readwrite');\n  tx.objectStore('cachedData').put({ key, data, timestamp: Date.now() });\n  return new Promise((resolve) => { tx.oncomplete = resolve; });\n};\n\n// Récupérer des données du cache local\nexport const getCachedData = async (key) => {\n  const db = await openDB();\n  const tx = db.transaction('cachedData', 'readonly');\n  const request = tx.objectStore('cachedData').get(key);\n  return new Promise((resolve) => {\n    request.onsuccess = () => resolve(request.result?.data || null);\n  });\n};\n\n// Sauvegarder une action à synchroniser plus tard\nexport const savePendingAction = async (action) => {\n  const db = await openDB();\n  const tx = db.transaction('pendingActions', 'readwrite');\n  tx.objectStore('pendingActions').add({\n    ...action,\n    timestamp: Date.now(),\n  });\n  return new Promise((resolve) => { tx.oncomplete = resolve; });\n};\n\n// Récupérer toutes les actions en attente\nexport const getPendingActions = async () => {\n  const db = await openDB();\n  const tx = db.transaction('pendingActions', 'readonly');\n  const request = tx.objectStore('pendingActions').getAll();\n  return new Promise((resolve) => {\n    request.onsuccess = () => resolve(request.result || []);\n  });\n};\n\n// Supprimer une action synchronisée\nexport const removePendingAction = async (id) => {\n  const db = await openDB();\n  const tx = db.transaction('pendingActions', 'readwrite');\n  tx.objectStore('pendingActions').delete(id);\n  return new Promise((resolve) => { tx.oncomplete = resolve; });\n};\n\n// Vérifier si on est en ligne\nexport const isOnline = () => navigator.onLine;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}